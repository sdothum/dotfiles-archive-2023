# sdothum - 2016 (c) wtfpl

# Make
# ══════════════════════════════════════════════════════════════════════════════

# ...................................................................... iosevka

usage() { echo "usage: $(basename $0) iosevka [kindle | kobo | I-serifless | d-tailed | q-curly | at-tall | paren-flat | book+regular | source-only]* | [-- <opions>*]"; exit 1; }

# with run examples with optional glyph variants..
#        make_install iosevka kobo q-curly                            # kobo fonts
#        make_install iosevka I-serifless f-extended q-curly at-long  # source code, web and e-reader fonts

MAKE_INSTALL=/tmp/iosevka:make_install
touch $MAKE_INSTALL
trap "rm -f $MAKE_INSTALL" EXIT
shift

while [ $1 ] ;do
  case $1 in
  I-serifless ) flavour=I-serifless ;;              # source code variant
  Q-tailed    ) Q=Q-tailed ;;
  d-tailed    ) d=d-tailed ;;                       # ebook variant
  f-extended  ) f=f-extended ;;                     # unolexic (homage to universal grotesk)
  q-curly     ) q=q-curly ;;                        # ebook variant
  at-tall     ) at=at-tall ;;                       # source code variant
  paren-flat  ) paren=paren-flat ;;                 # source code variant
  book+regular) adjust=book+regular ;;
  source-only ) source_only=true ;;
  kindle      ) ereader=$1; adjust=book+regular ;;  # add regular/book weight blending (for small fonts on Kindle)
  kobo        ) ereader=$1; q=q-curly ;;
  --          ) shift; . $HOME/bin/functions/font/iosevka $@; exit ;;
  *           ) usage ;;
  esac
  shift
done

# build font suite
ifno 'build iosevka font suite' && { rm -f $MAKE_INSTALL; exit; }

update() {
  fonts='*-book *-bookitalic *-bold *-bolditalic'
  cd $HOME/.fonts/$2

  for i in $fonts ;do
    file=$i.ttf
    folder=$STOW/$ereader/fonts/$1
    mkdir -p $folder
    cp -v $file $folder/
  done
}

if [ $ereader ] ;then
  # serifed I
  iosevka dyslexic $ereader english d-tailed $Q $q $adjust family e_Monolexic
  update d-tailed e_Monolexic
  iosevka dyslexic $ereader english $Q $q $adjust
  update p-serifed eMonolexic
  # serifless I
  iosevka dyslexic $ereader english I-serifless d-tailed $Q $q $adjust family _Monolexic
  update d-tailed _Monolexic
  iosevka dyslexic $ereader english I-serifless $Q $q $adjust family Monolexic            # my monolexic default settings
  update p-serifed Monolexic
  # extended f
  iosevka dyslexic $ereader english f-extended $Q $q $adjust family eUnolexic
  update p-serifed eUnolexic
  iosevka dyslexic $ereader english I-serifless f-extended $Q $q $adjust family Unolexic  # my unolexic default settings
  update p-serifed Unolexic
else
  # desktop fonts
  iosevka expanded $flavour $d $f $Q $q $at $paren
  iosevka expanded proof $flavour $d $f $Q $q $at $paren
  iosevka expanded menu $flavour $d $f $Q q-curly $at $paren
  [ $source_only ] && exit

  # www fonts
  iosevka heading english I-serifless $f $Q q-curly
  iosevka dyslexic english I-serifless $f $Q q-curly kobo webfont
  iosevka dyslexic english quasi-proportional space 1.25 I-serifless $f $Q q-curly kobo webfont

  # e-reader fonts
  iosevka ebook english d-tailed $Q $q $adjust
  iosevka ebook english I-serifless $f $Q $q $adjust
  iosevka ebook english quasi-proportional d-tailed $Q $q $adjust
  iosevka ebook english quasi-proportional I-serifless $f $Q $q $adjust
  iosevka dyslexic english quasi-proportional d-tailed $Q $q $adjust
  iosevka dyslexic english quasi-proportional I-serifless $f $Q $q $adjust
fi

# vim: set ft=sh: #
