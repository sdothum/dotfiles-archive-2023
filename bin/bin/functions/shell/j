#!/usr/bin/dash
# sdothum - 2016 (c) wtfpl

# Shell
# ══════════════════════════════════════════════════════════════════════════════

# ................................................................... Fuzzy jump

usage() { echo "usage: $(basename $0) -- | [-] [dir] [<pattern>]"; }

# refresh directory cache, see fcache
case $1 in
  '') usage; sleep 1 ;;
  --) exec fcache I ;;
  - ) refresh=$1; shift ;;
esac

# fish shell ignores non-fish cd's, see j.fish
case $# in
  0) pwd | grep -q $HOME && { dir=$(fcache $refresh $HOME | fZf); exit; } || dir=$(fcache $refresh $PWD | fZf) ;;
  1) [ -d $1 ] && dir=$(fcache $refresh $1 | fZf) || dir=$(fcache $refresh $HOME | fZf -q $1) ;;
  2) [ -d $1 ] && dir=$(fcache $refresh $1 | fZf -q $2) || dir=$(fcache $refresh $HOME | grep -E "$1" | fZf -q $2) ;;
esac

[ $dir ] && cd $dir

# vim: set ft=sh: #
